{"ast":null,"code":"import { Immediate } from '../util/Immediate';\nimport { AsyncAction } from './AsyncAction';\nexport class AsapAction extends AsyncAction {\n  constructor(scheduler, work) {\n    super(scheduler, work);\n    this.scheduler = scheduler;\n    this.work = work;\n  }\n\n  requestAsyncId(scheduler, id, delay = 0) {\n    if (delay !== null && delay > 0) {\n      return super.requestAsyncId(scheduler, id, delay);\n    }\n\n    scheduler.actions.push(this);\n    return scheduler.scheduled || (scheduler.scheduled = Immediate.setImmediate(scheduler.flush.bind(scheduler, null)));\n  }\n\n  recycleAsyncId(scheduler, id, delay = 0) {\n    if (delay !== null && delay > 0 || delay === null && this.delay > 0) {\n      return super.recycleAsyncId(scheduler, id, delay);\n    }\n\n    if (scheduler.actions.length === 0) {\n      Immediate.clearImmediate(id);\n      scheduler.scheduled = undefined;\n    }\n\n    return undefined;\n  }\n\n}","map":{"version":3,"sources":["../../../src/internal/scheduler/AsapAction.ts"],"names":[],"mappings":"AAAA,SAAS,SAAT,QAA0B,mBAA1B;AACA,SAAS,WAAT,QAA4B,eAA5B;AAQA,OAAM,MAAO,UAAP,SAA6B,WAA7B,CAA2C;AAE/C,EAAA,WAAA,CAAsB,SAAtB,EACsB,IADtB,EACyE;AACvE,UAAM,SAAN,EAAiB,IAAjB;AAFoB,SAAA,SAAA,GAAA,SAAA;AACA,SAAA,IAAA,GAAA,IAAA;AAErB;;AAES,EAAA,cAAc,CAAC,SAAD,EAA2B,EAA3B,EAAqC,KAAA,GAAgB,CAArD,EAAsD;AAE5E,QAAI,KAAK,KAAK,IAAV,IAAkB,KAAK,GAAG,CAA9B,EAAiC;AAC/B,aAAO,MAAM,cAAN,CAAqB,SAArB,EAAgC,EAAhC,EAAoC,KAApC,CAAP;AACD;;AAED,IAAA,SAAS,CAAC,OAAV,CAAkB,IAAlB,CAAuB,IAAvB;AAIA,WAAO,SAAS,CAAC,SAAV,KAAwB,SAAS,CAAC,SAAV,GAAsB,SAAS,CAAC,YAAV,CACnD,SAAS,CAAC,KAAV,CAAgB,IAAhB,CAAqB,SAArB,EAAgC,IAAhC,CADmD,CAA9C,CAAP;AAGD;;AACS,EAAA,cAAc,CAAC,SAAD,EAA2B,EAA3B,EAAqC,KAAA,GAAgB,CAArD,EAAsD;AAI5E,QAAK,KAAK,KAAK,IAAV,IAAkB,KAAK,GAAG,CAA3B,IAAkC,KAAK,KAAK,IAAV,IAAkB,KAAK,KAAL,GAAa,CAArE,EAAyE;AACvE,aAAO,MAAM,cAAN,CAAqB,SAArB,EAAgC,EAAhC,EAAoC,KAApC,CAAP;AACD;;AAID,QAAI,SAAS,CAAC,OAAV,CAAkB,MAAlB,KAA6B,CAAjC,EAAoC;AAClC,MAAA,SAAS,CAAC,cAAV,CAAyB,EAAzB;AACA,MAAA,SAAS,CAAC,SAAV,GAAsB,SAAtB;AACD;;AAED,WAAO,SAAP;AACD;;AArC8C","sourcesContent":["import { Immediate } from '../util/Immediate';\nimport { AsyncAction } from './AsyncAction';\nexport class AsapAction extends AsyncAction {\n    constructor(scheduler, work) {\n        super(scheduler, work);\n        this.scheduler = scheduler;\n        this.work = work;\n    }\n    requestAsyncId(scheduler, id, delay = 0) {\n        if (delay !== null && delay > 0) {\n            return super.requestAsyncId(scheduler, id, delay);\n        }\n        scheduler.actions.push(this);\n        return scheduler.scheduled || (scheduler.scheduled = Immediate.setImmediate(scheduler.flush.bind(scheduler, null)));\n    }\n    recycleAsyncId(scheduler, id, delay = 0) {\n        if ((delay !== null && delay > 0) || (delay === null && this.delay > 0)) {\n            return super.recycleAsyncId(scheduler, id, delay);\n        }\n        if (scheduler.actions.length === 0) {\n            Immediate.clearImmediate(id);\n            scheduler.scheduled = undefined;\n        }\n        return undefined;\n    }\n}\n//# sourceMappingURL=AsapAction.js.map"]},"metadata":{},"sourceType":"module"}